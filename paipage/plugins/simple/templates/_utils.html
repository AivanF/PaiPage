{% macro page_card(page) -%}
{% set txt = page.get_text(lang) -%}
{%- if txt -%}
<div class="page-card">
	<h3>
		{%- if should_show(page,txt) %}<a href="/{{ page.url }}">{% endif -%}
		{{ txt.title }}
		{%- if should_show(page,txt) %}</a>{% endif -%}
	</h3>
	{{ render_page_short(page,txt) |safe }}
</div>
{%- endif -%}
{%- endmacro %}

{% macro page_contents(children, max_level=5, level=1) -%}
<ul>{% for page in children -%}
	{% set txt = page.get_text(lang) -%}
	{% if txt -%}
		{%- if should_show(page,txt) %}<a href="/{{ page.url }}">{% endif -%}
		<li>
			{{ txt.title }}
			{% if level < max_level -%}
			{{ page_contents(page.children.all(), max_level, level+1) }}
			{%- endif %}
		</li>
		{%- if should_show(page,txt) %}</a>{% endif %}
	{%- endif %}
{%- endfor %}</ul>
{%- endmacro %}

{% macro make_upper(upper) -%}
{% if upper -%}
	{% set txt = upper.get_text(lang) -%}
	{%- if txt -%}
	{%- if txt.text_full|length > 0 %}
	<div class="upheader"><a href="/{{ upper.url }}">
		<span class="glyphicon glyphicon-share-alt"></span>
		{{ txt.title }}
	</a></div>
	{%- endif -%}
	{%- endif -%}
{%- endif %}
{%- endmacro %}
